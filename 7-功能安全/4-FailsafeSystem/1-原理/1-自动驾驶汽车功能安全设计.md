# 概念解析

## 分级概念

智能网联汽车自动驾驶包括有条件自动驾驶、高度自动驾驶和完全自动驾驶。有条件自动驾驶是指在系统的设计运行条件下完成所有动态驾驶任务，根据系统动态驾驶任务接管请求，驾驶人应提供适当的干预；高度自动驾驶是指在系统的设计运行条件下完成所有动态驾驶任务，在特定环境下系统会向驾驶人提出动态驾驶任务接管请求，驾驶人/乘客可以不响应系统请求；完全自动驾驶是指系统可以完成驾驶人能够完成的所有道路环境下的动态驾驶任务，不需要驾驶人/乘客介入。<br />设计运行条件（Operational Design Condition，ODC）是驾驶自动化系统设计时确定的适用于其功能运行的各类条件的总称，包括设计运行范围、车辆状态和驾乘人员状态等条件。其中，设计运行范围（Operational Design Domain，ODD）是驾驶自动化系统设计时确定的适用于其功能运行的外部环境条件，一般包括：1）道路边界与路面状态；2）交通基础设施；3）临时性道路变更；4）其他交通参与者状态；5）自然环境；6）网联通信、数字地图支持等条件。<br />《安全指南》第1、2条要求，自动驾驶系统应有明确的设计运行范围（ODD），并采取相应措施，确保车辆在ODD范围内安全运行。系统供应商应根据自动驾驶汽车的性能及使用方式确定设计运行范围，例如具体运行的道路条件（高速公路、普通道路、车道数目等）、地理条件（城市、山区等）、环境条件（天气状况、夜间等）、其他条件（限速、特定道路运行、安全人员乘车与否等），并对自动驾驶汽车引发的人身事故进行合理预见并预防其发生。在确定ODD范围之后，自动驾驶系统应在ODD范围内启动，司机应能控制自动驾驶系统的启动。厂商应确保控制系统及传感器必须有冗余，保障系统安全。如果车辆运行超出ODD范围，L3级自动驾驶系统应向司机发出警告要求介入，而L4级自动驾驶系统应能自动将车辆停到安全的地方。<br />《安全指南》要求应有确保自动驾驶系统良好运作的人机交互机制和技术措施保障。具体而言，厂商和经销商应采取措施，让驾驶员了解包括系统使用方法、ODD范围、系统异常时车辆的反应、适当进行软件升级等一系列信息。例如，该指南第4条规定，自动驾驶系统的人机界面（HMI）应能监控驾驶员，确保驾驶员可以随时接管车辆操作，包括必要时发出警报（L3级别）或能让驾驶员或乘客事先知道车辆会自动停止前进（L4级别）。L4级别的自动驾驶汽车应设置摄像头和声音通信设备，使运行管理中心可以监控车内状况，且应在乘客可轻易触碰到的地方设置紧急停止按钮。该指南第7条还规定，在紧急状况停车或有事故时，系统应能自动通报运行管理中心；车辆紧急停止时和运行管理中心的联络，以及紧急状况下的应对情况，应能通过人机界面方便地传递给乘客。

## 用户功能

自动驾驶系统用户功能，指的是自动驾驶系统在特定条件下展现出的、能被用户直接感知的行为。分析用户功能时，需将自动驾驶系统视为黑盒。<br />参考市面上已出现的各类自动驾驶技术，可提取出以下自动驾驶系统功能点：

- 泊车Parking

ADS系统控制车辆在可用停车位内完成泊车。

- 车速保持Maintain Speed

ADS系统通过纵向控制维持安全车速，以保证合适的跟车距离。

- 跟车Car Following

ADS系统通过横纵向控制，识别并跟踪目标车辆行驶，并保证合适的跟车距离。

- 车道居中Lane Centering

ADS系统通过横向控制保持车辆在车道内行驶。

- 变道/超车Lane Switching/Overtaking

ADS系统根据路径规划或风险避让需求，控制车辆变道或超车。

- 增强与其它交通参与者的交互Enhancing Conspicuity

ADS系统通过控制灯光、信号装置等措施与其它交通参与者进行交互。

- 并道Merge

ADS系统识别可用车道及匹配车速，控制车辆并入目标车道。

- 驶入/驶出匝道Navigate On/off Ramps

ADS系统控制车辆驶入/驶出匝道。

- 遵守驾驶法规Follow Driving Laws

ADS系统可遵守各地不同的驾驶法规（跟车距离、限速、交通标志等）。

- 环岛引导Navigate Roundabouts

ADS系统确定道路通行权、驶入、引导和驶出环岛，并与周边其它道路使用者的必要交互。

- 路口引导Navigate Intersection

ADS系统确定道路通行权、驶入、引导和驶出路口，包括了对信号灯、停车标志、4/3/2多车道信息的处理及与周边其它道路使用者的交互。

- 人行横道引导Navigate Crosswalk

ADS系统确定道路通行权、驶入、引导和驶出人行横道，并与周边其它道路使用者的必要交互。

- 施工区域引导Navigate Work Zone

ADS系统确定道路通行权和交通模式、驶入、引导和驶出施工区域，并与周边其它道路使用者的必要交互。

- N-Point Turn

ADS系统控制车辆在狭窄空间内交替进行多次前进、后退（转向），调整行驶方向。

- 掉头U-Turn

ADS系统确定道路通行权，控制车辆掉头，并与周边其它道路使用者的必要交互。

- 路径规划Route Planning

ADS系统使用各种道路信息决策行驶路径。<br />目前典型的自动驾驶系统ADS可分为以下七种类型：

- L3级自动驾驶：**Traffic Jam Pilot(TJP) 阻塞交通领航**
- L3级自动驾驶：Highway Pilot(HWP)
- L4级自动驾驶：**Low Speed Shuttle 低速穿梭**
- L4级自动驾驶：**Automated Valet Parking (AVP) 自动泊车**
- L4级自动驾驶：**Automated Emergency Take-Over 自动紧急接管**
- L4级自动驾驶：Highway Drive
- L4级自动驾驶：**Robo-taxi 自动驾驶出租车**

# 驾驶任务

基于功能安全设计驾驶任务

## 基本驾驶任务

对驾驶任务进一步分解，可得到下表1。需要指出的是：驾驶员或系统可同时进行下表1中的几项驾驶任务，其中“基本驾驶任务”为首要驾驶任务，也是驾驶自动化等级划分的主要依据，其它驾驶任务为第二、第三驾驶任务。<br />![](https://cdn.nlark.com/yuque/0/2022/png/23125517/1671423123298-4f071cff-deb9-4995-b71f-76a499796b63.png#averageHue=%23f7f7f7&clientId=uf6366bc0-124d-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=ub4a7e131&margin=%5Bobject%20Object%5D&originHeight=514&originWidth=668&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u4cb093ec-3034-476c-a75f-a2a0a1acfcb&title=)

## 策略性任务Strategic functions

DDT的上层输入为：策略性功能Strategic functions，具体包括行程规划、目的地和路径选择等导航类功能。

## 动态驾驶任务DDT

车辆运动控制与OEDR（目标和事件探测与响应Object and Event Dection and Reponse）组合就形成了完整的动态驾驶任务DDT。<br />![](https://cdn.nlark.com/yuque/0/2022/png/23125517/1671423123455-a1a08c9a-4944-4061-834b-4c0be5ef6966.png#averageHue=%23eeeeee&clientId=uf6366bc0-124d-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u6b659e63&margin=%5Bobject%20Object%5D&originHeight=321&originWidth=656&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u97ef1be9-3546-490a-96de-4a9bb5cae09&title=)<br />属于基本驾驶任务范畴，除策略性功能外，完成车辆驾驶所需的感知、决策和执行等行为，包括但不限于：<br />- 车辆横向运动控制；<br />- 车辆纵向运动控制；<br />- 目标和时间探测与响应；<br />- 驾驶决策；- 车辆照明及信号装置控制。<br />动态驾驶任务包括所有实时操作和决策功能，由驾驶员或驾驶自动化系统完成，或两者共同完成。

## 动态驾驶任务接管DDT fallback

当发生驾驶自动化系统失效、车辆关联系统失效或即将不满足设计运行条件时，由驾驶员/系统执行动态驾驶任务、使车辆达到最小风险状态的行为。

## 时间约束

**以上三层驾驶任务的作用时间分别为：**

- Strategic functions：10s~；策略性任务
- Tactical functions：(1~10)s；驾驶决策
- Operational functions：(0.01~0.1)s。车辆控制

# 人机交互

## 定义

自动驾驶系统HMI的目的在于优化人类对任务和情况的理解，减少意外误用或不正确的操作，其最重要和最具挑战性的目标在于使用户正确地理解当前实际的驾驶模式，以及该模式下附属的用户责任和驾驶任务。<br />![](https://cdn.nlark.com/yuque/0/2022/png/23125517/1671423123359-74c17aee-4aab-4177-887c-4abcebe72864.png#averageHue=%23467b9a&clientId=uf6366bc0-124d-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=udd1d2d00&margin=%5Bobject%20Object%5D&originHeight=438&originWidth=701&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u7d379d24-00ef-4e8f-ba92-4c6020a7801&title=)<br />![](https://cdn.nlark.com/yuque/0/2022/png/23125517/1671423123344-1f39ea9f-e4bd-47f3-9537-aa7a5e316577.png#averageHue=%23f5f5f5&clientId=uf6366bc0-124d-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u954f79cb&margin=%5Bobject%20Object%5D&originHeight=757&originWidth=675&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u9535f5c0-89ea-42ec-955e-077e6522f8c&title=)<br />在L0级到L5级中，L3级自动驾驶属于人机共驾阶段，当满足一定设计运行条件时，将首次允许人类驾驶员完全交出车辆控制权。因此在L3级自动驾驶车辆运行时，用户将会体验到自动驾驶系统具有多个不同任务和职责的工作模式，非常容易造成模式混乱和责任扩散。对于L3级以下的系统，目前市场上出现了很多L2+、L2++、L2.5、L2.9、L2.99等概念，这些都容易造成用户混淆，使用户产生误用行为，威胁自动驾驶系统的运行安全。L3级以上的L4级自动驾驶，虽然进一步转移了驾驶员需要承担的驾驶任务，但因为系统无法覆盖所有设计运行区域ODD，所以在ODD以外同样面临多种工作模式及驾驶控制器权切换的问题。同时，L4级自动驾驶系统的HMI还可能在Robotaxi、自主泊车等服务中需要向车辆外部的道路使用者传递系统运行信息。

## 场景

自动驾驶人机交互功能的最主要目标就是实现自动驾驶系统与驾驶员之间的相互理解，保证自动驾驶系统的安全运行。因此，针对表1中不同驾驶自动化等级下的人机功能分配差异，自动驾驶系统对人机交互的功能需求也存在差异，具体来说可分以下四类功能：<br />**Ⅰ类HMI功能**仅显示自动驾驶系统的工作状态及提供必要的报警提示。适用于L0级驾驶自动化系统。<br />**Ⅱ类HMI功能**在Ⅰ类HMI功能基础上，增加请求驾驶员接管提示。适用于L1、L2级驾驶自动化系统。<br />**Ⅲ类HMI功能**在Ⅱ类HMI功能基础上，进一步增加驾驶员状态监控；自动驾驶系统设计运行区域监测；在必要时配合整个系统执行最小风险策略。适用于L2、L3级驾驶自动化系统。<br />**Ⅳ类HMI功能**在有人驾驶模式下，需提供Ⅲ类HMI所有功能，同时可支持驾驶员在车外的无人驾驶模式。适用于L4、L5级驾驶自动化系统。<br />![](https://cdn.nlark.com/yuque/0/2022/png/23125517/1671423123290-14d97d54-1c08-4d41-9e30-621dcd27992e.png#averageHue=%23f9f8f8&clientId=uf6366bc0-124d-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=ucd1f79c2&margin=%5Bobject%20Object%5D&originHeight=339&originWidth=703&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=uef246a70-ead8-49fc-ad94-aaa7338d46a&title=)<br />![](https://cdn.nlark.com/yuque/0/2022/png/23125517/1671423124041-1a85c7cc-a6e5-437d-b549-2dd61f94eaf5.png#averageHue=%23e6e5e5&clientId=uf6366bc0-124d-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u2bd43565&margin=%5Bobject%20Object%5D&originHeight=445&originWidth=449&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u30a2e96b-2ffe-422a-845f-8eb01d2d372&title=)<br />被动功能安全的HMI<br />![](https://cdn.nlark.com/yuque/0/2022/png/23125517/1671423124139-bd7963a9-e271-4664-a08a-61e1b961783f.png#averageHue=%23f8f8f7&clientId=uf6366bc0-124d-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u627a2916&margin=%5Bobject%20Object%5D&originHeight=424&originWidth=696&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u4cc29841-4eeb-4ed0-8cfb-b7052f288be&title=)<br />主动功能安全的HMI<br />![](https://cdn.nlark.com/yuque/0/2022/png/23125517/1671423124214-31b14ccc-05f7-456f-a87a-1788d75d4e5c.png#averageHue=%23f7f6f5&clientId=uf6366bc0-124d-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u5301802f&margin=%5Bobject%20Object%5D&originHeight=374&originWidth=703&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u5d3fdba3-5f96-4572-b2b6-992b81687e8&title=)

## 人机交互太难

今年5月，**奥迪**技术总监Hans在接受Automotive News Europe的采访时表示，奥迪将不会在全球范围内为现款A8引入TJP功能。然而这已经不是第一家国际大厂放弃L3了，比如**福特**在经过几年的挣扎后，2019年初就正式宣布放弃L3；**沃尔沃**同样也已宣布放弃L3已久。从这个角度看，奥迪也不是个先驱。而让奥迪又因为L3上了头条的原因是，他曾是全球第一个宣布L3已经进入量产车的厂商，也就是2018年宣布的新一代A8。<br />![](https://cdn.nlark.com/yuque/0/2022/png/23125517/1671423124213-c08eae37-6bec-4de8-beba-c19509f768ad.png#averageHue=%23acdac6&clientId=uf6366bc0-124d-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=uedb164d3&margin=%5Bobject%20Object%5D&originHeight=493&originWidth=641&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=uaae5c050-fc26-4eb1-86c6-3be2901d671&title=)<br />L3，在限定场景下，系统会负责观察环境并给出合理的反应，自动控制方向盘和油门刹车，但是当系统失效了，还需要驾驶员来接管。<br />**举例：**在高速上，自适应巡航+变道超车时，前面大车轮子上甩过来一滩泥挡在了摄像头上，本车就报警说：我看不到啦，驾驶员，要靠你啦。<br />很清楚，L3的定义可以简化成一句话：看路不要你，开车不要你，出了事一半算你的。<br />为什么一半算你的？我们来看一下这个过程的产品逻辑细节：因为在正常行驶的时候，驾驶员是不需要负责观察道路环境的，所以不论是外面的雨突然变大、转了个弯突然变成太阳直射过来导致摄像头逆光成像质量下降、还是前面的卡车甩了一小块泥在你的摄像头上，驾驶员都是有可能不知道的。而驾驶员在L3级自动驾驶系统的加持下，是被允许打电话、回微信、搞两把农药、追个综艺甚至把座椅放平睡觉的。而当这个L3的系统自己搞不定的时候，他又是被允许要求驾驶员接管的。那么关键就来了，L3的系统需要在撞车之前把控制权交回驾驶员手中，这是无法保证的。这个人机交互过程的技术实现非常复杂，且具有偶然性。

## L2.5的能力L3的交互

当前车企的策略是，不宣称L3，讲L4的概念，赚L2的钱，规避法律风险。都是学特斯拉的。

## 人机交互需要智能座舱

两个方向，此处略去不讨论。

- 自然人机交互
- 驾驶员意图感知

# 功能安全对人机交互的要求

通常意义上，汽车的人机交互只发生在车与车内用户之间。但对于装备有自动驾驶系统的汽车来说，其必须向车辆外部的周边交通参与者发出一定的提示报警信息，以提醒对方本车当前的运行状态，因此自动驾驶人机交互对象包括车内用户和车外周边交通参与者两部分。

## 车内用户

![](https://cdn.nlark.com/yuque/0/2022/png/23125517/1671423124336-3c1a8234-750b-42a0-9022-4b59e8296aca.png#averageHue=%23fafafa&clientId=uf6366bc0-124d-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u73b1dce9&margin=%5Bobject%20Object%5D&originHeight=284&originWidth=445&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u1d979a1d-d627-4442-a232-0eec5b45e04&title=)

### **开启/关闭指令**

- **开启/关闭装置**
- **自动驾驶系统开启使能条件**
- **自动驾驶系统关闭要求**

### 信息显示

- **系统运行状态**
- **系统请求驾驶员接管和进入最小风险控制MRM时的信息**
- **系统进入紧急控制EM时的信息**

## 车外交通参与者

在自动驾驶系统激活时，应通过必要的车外人机交互方式向周边交通参与者（车辆、行人、非机动车等）发出报警提示信息，以使对方可以理解自车的驾驶行为，并作出适当的反应。

### **车外人机交互方式**

- **灯光类：**制动灯、转向灯、危险警报灯等；
- **声音类：**倒车蜂鸣器、行人警示器、外置高音喇叭等；
- **车联网V2X**。

### **车外人机交互信息**

- **必须项**

‒ 自动驾驶系统或用户触发制动系统，并导致车辆有制动动作时，需点亮制动灯；‒ 自动驾驶系统或驾驶员控制转向系统，并导致车辆有转向或变道动作时，需点亮对应侧的转向灯；‒ 自动驾驶系统或用户触发驻车制动系统，并导致车辆保持驻车状态时，需点亮驻车制动灯；‒ 自动驾驶系统或用户触发紧急制动系统，并导致车辆有紧急制动动作时，需倍频点亮制动灯和危险警报灯。

- **建议项**

‒ 对本车造成威胁的目标车辆需使用远近光灯交替示意；‒ 本车处于急转弯影响视野时，需使用远近光灯交替示意或鸣喇叭示意；‒ 本车处于坡道影响安全视距时，需使用远近光灯交替示意或鸣喇叭示意；‒ 必要时提供外置语音播报；‒ 必要时可通过V2X进行信息交互或远程控车。

## 用户接管和主动干预

根据SAE J3016标准的定义，从L0级到L3级的驾驶自动化系统都要求人类驾驶员作为动态驾驶任务后援DDT fallback，在必要时可以接管驾驶控制。即使到了L4级自动驾驶，由于系统无法覆盖所有驾驶场景，因此在超出设计运行区域ODD时，人类驾驶员也需要接管驾驶控制。<br />接管的本质就是车辆驾驶控制权在“人”与“机”之间的转换问题，根据驾驶权转换的发起者和执行者不同，接管可分为由自动驾驶系统发起的被动接管和由用户发起的主动干预。<br />![](https://cdn.nlark.com/yuque/0/2022/png/23125517/1671423124673-ff8a2387-805c-4ed7-bb1b-cfda71da69f5.png#averageHue=%23fbfbfb&clientId=uf6366bc0-124d-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=uec8384bb&margin=%5Bobject%20Object%5D&originHeight=232&originWidth=499&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=ue922938f-5bec-44b6-9fbd-01dc084fc76&title=)<br />被动接管的准确定义为：当出现动态驾驶任务DDT相关的系统失效或车辆超出设计运行区域ODD范围时，由自动驾驶系统向用户发出接管请求，用户通过控制横纵向运动控制的方式予以响应。被动接管强调由自动驾驶系统发起，用户被动执行。<br />主动干预的准确定义为：用户在自动驾驶系统仍处于活动状态时，主动向横纵向运动控制装置提供输入，系统根据用户的输入是否达到阈值选择退出功能还是继续执行动态驾驶任务DDT。主动干预则强调由用户主动发起。

### 接管时序

触发自动驾驶系统发出接管请求的事件可分为可预期事件和意外事件两类：由可预期事件触发的接管请求通常属于非紧急状况的驾驶权转换，系统应尽早向用户发出接管请求，以保证用户有足够的时间完成接管动作；由意外事件触发的接管请求通常属于紧急状况的驾驶权转换，一般难以保证用户有足够的接管时间。<br />当可预期事件触发了非紧急状况下的被动接管时，自动驾驶系统应继续运行。如果用户在一段时间后仍未及时恢复对车辆的控制，自动驾驶系统应能进入最小风险控制MRM，可通过逐步降低车速，确保车辆在可预期事件发生前刹停。

### 主动干预

自动驾驶系统可允许有多种主动干预实现方式，例如用户可通过操控制动踏板、加速踏板、驻车制动开关、转向灯开关、危险警报灯开关等不同方式实施主动干预。<br />**而根据用户采用的干预方式，自动驾驶系统可实现可逆干预和不可逆干预两种响应**：

- 不可逆干预：用户实施不可逆干预后，自动驾驶系统退出；
- 可逆干预：用户可选择只干预一部分动态驾驶任务，自动驾驶系统仍可执行剩余部分的动态驾驶任务，当用户干预撤出后，自动驾驶系统可恢复执行所有动态控制任务。

自动驾驶系统的报警类功能和运动控制类功能对用户干预的响应策略可分为以下三类：

- 对于报警类的驾驶辅助功能，主动干预可作为**系统报警的抑制条件**，如制动操作可抑制碰撞报警FCW、转向灯操作可抑制车道偏离预警LDW等；

对于运动控制类功能，当用户干预和系统请求冲突时

- L3级及以下的系统优先响应用户请求；
- L3级以上的系统应首先保证车辆运行安全，在此前提下再响应用户请求。

## 最小风险策略MRM

自动驾驶人机交互有一项基本要求为：当用户无法及时响应自动驾驶系统发出的接管请求时，自动驾驶系统应执行最小风险策略MRM，以保证车辆运行安全<br />这里最小风险策略MRM（Minimal risk maneuver）的概念源于功能安全标准ISO 26262，其准确定义为：在驾驶自动化系统或用户无法执行动态驾驶任务或动态驾驶任务接管时，驾驶自动化系统所采取的降低风险的措施。<br />![](https://cdn.nlark.com/yuque/0/2022/png/23125517/1671423124687-537d7d34-6113-4614-8797-a76b7a1dbfe4.png#averageHue=%23f9f9f8&clientId=uf6366bc0-124d-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u243a21cc&margin=%5Bobject%20Object%5D&originHeight=365&originWidth=682&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=ufb532bef-3f96-4cf9-9ed2-653deff021d&title=)

### 策略的能力

最小风险策略MRM需要对风险缓解进行有效识别和判断，再结合驾驶员对车辆的控制状态，采取必要的控制措施。MRM需要的感知、决策和执行能力，包括但不限于：

- 车辆横向运动控制；
- 车辆纵向运动控制；
- 目标与实践探测；
- 控制决策；
- 车辆照明及信号装置控制；
- 远程信息交互。

例如极星polestar2，其环境感知传感器架构为3R1V（1前向摄像头+1前向毫米波雷达+2后角毫米波雷达），未配备足够的侧向环境感知传感器，因此在自动驾驶系统出现异常且驾驶员未能有效介入动态驾驶任务时，polestar2只能实现单车道内的减速或停车可控制，无法实现跨越车道级的靠路边停车或紧急车道停车。

### 策略的合理性

最小风险策略MRM的合理性，极大地影响着自动驾驶系统用户和外部交通参与者的安全性。因此在自动驾驶系统设计过程中，需针对不同的失效场景、结合自动驾驶系统设计方案，“量身定制”最小风险策略的具体内容，过激的策略和过于保守的策略，都将对自动驾驶系统的运行安全造成较大影响。<br />**危害场景**<br />自动驾驶系统可能触发最小风险策略MRM的危害场景有：<br />‒ 自动驾驶系统环境感知功能失效或能力受限；<br />‒ 车辆超出自动驾驶系统设计运行区域ODD的定义范围；<br />‒ 驾驶员监控系统DMS确认驾驶员当前状态异常，无法正常承担驾驶任务；<br />‒ 自动驾驶系统规划控制单元或执行器发生失效。

# 功能安全对其他模块的要求

![](https://cdn.nlark.com/yuque/0/2022/png/23125517/1671423124854-33567a1b-0f91-4f2e-9ece-540a33bdbb26.png#averageHue=%23c4d5de&clientId=uf6366bc0-124d-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=uda31c30c&margin=%5Bobject%20Object%5D&originHeight=559&originWidth=1074&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=ub48dd1bf-d6f1-45ac-b8f1-e29dba6a273&title=)<br />图2中关键功能要素介绍如下：

- 环境感知

环境感知传感器需要获取所有外部信息，用以创建世界模型。需要检测的实体包括但不限于定义可行驶区域的设施、弱势道路使用者、障碍物、交通标志和声音信号。

- 先验感知

主要包括高精地图和GNSS定位，用于“检测”环境感知传感器无法轻易检测到的物体，或提供冗余感知信息源。

- 解释与预测

基于知识、规则和经验，对其它道路使用者的行为进行预测。

- 定位

结合环境感知及先验感知信息，精确地知道自车的位置

- 自车运动

实时检测自车当前运动状态，主要包括：轮速/车速、横摆角速度、纵向加速度、横向加速度、方向盘转角等。

- 驾驶规划

在不影响舒适度或交通流量的情况下，制定可以实现无碰撞驾驶的驾驶策略。

- 运动控制

为实现所需的车辆运动，需根据规划路径，向纵向运动控制及横向运动控制执行器输出精确控制命令。

- 人机交互

提供了人与系统之间的交互界面，用于交换信息及操作。

- 驾驶员状态确定

用于检测驾驶员属性，例如驾驶员注意力分散或对驾驶模式混淆。

- 车辆状态

自动驾驶系统除承担动态驾驶任务外，还需承担对车辆状态的监控和维护职责，具体包括：

# 功能安全模块建模

设计运行条件（Operational Design Condition，ODC）是驾驶自动化系统设计时确定的适用于其功能运行的各类条件的总称，包括设计运行范围、车辆状态和驾乘人员状态等条件。<br />设计运行范围（Operational Design Domain，ODD）是驾驶自动化系统设计时确定的适用于其功能运行的外部环境条件，一般包括：1）道路边界与路面状态；2）交通基础设施；3）临时性道路变更；4）其他交通参与者状态；5）自然环境；6）网联通信、数字地图支持等条件。<br />![](https://cdn.nlark.com/yuque/0/2022/png/23125517/1671423124953-8a0898d7-b4a4-4dac-92cd-3e36a21ad944.png#averageHue=%23818982&clientId=uf6366bc0-124d-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u4328df26&margin=%5Bobject%20Object%5D&originHeight=406&originWidth=469&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=ud4c96fe4-5b99-45d1-a066-47b0f23cf7f&title=)<br />对于每一个feature都有一个odd范围。<br />设计运行域ODD可以理解为智能驾驶功能开启的使能条件，设计运行域限制越严格，意味着智能驾驶功能的可用性越差。但设计运行域是智能驾驶系统产品设计、安全分析、仿真测试等工作的关键输入，具有不可替代的重要意义，因此在工程上必须建立标准化、结构化的描述方法。<br />![](https://cdn.nlark.com/yuque/0/2022/png/23125517/1671423124883-e0751116-aaee-4fd1-ba36-1a84af1d2567.png#averageHue=%23d6e2a2&clientId=uf6366bc0-124d-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u46988637&margin=%5Bobject%20Object%5D&originHeight=284&originWidth=470&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=ufb580d2a-31d8-44fe-a690-b7c0ab50dc7&title=)<br />![](https://cdn.nlark.com/yuque/0/2022/png/23125517/1671423125207-efe54fb3-d7b6-4bb3-85a3-3f31ef3e66c2.png#averageHue=%23a19f87&clientId=uf6366bc0-124d-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=ucd17c0f8&margin=%5Bobject%20Object%5D&originHeight=491&originWidth=639&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u0a3ba507-6e10-49d9-b8bd-22e540040e1&title=)<br />![](https://cdn.nlark.com/yuque/0/2022/png/23125517/1671423125197-fd887931-4942-46a8-8d41-72ab59287348.png#averageHue=%23dbdbdb&clientId=uf6366bc0-124d-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=u20648da8&margin=%5Bobject%20Object%5D&originHeight=387&originWidth=671&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u21a9e5df-d9b2-45be-9b7e-add03c43746&title=)<br />**六大构建要素：基础设施Physical Infrastructure、驾驶操作限制Operational Constraints、周边物体Objects、互联Connectivity、环境条件Environmental Conditions和区域Zones。**

## odd范围界定

### 基础设施

3) 道路边缘<br />道路边缘包括车道线、路肩、混凝土护栏、栅栏、栏杆、路缘石等不同种类。<br />4) 道路几何<br />所谓道路几何指的是道路的外形，其包含的属性值有：直路、弯道、坡道、转角、车道宽度等。

### **驾驶操作限制**

1) 限速<br />含允许的最高车速和最低车速。<br />2) 交通条件<br />交通条件包括交通流量（最低、峰值、正常）和交通条件变化（事故、紧急车辆通行、维修、封路、特殊事件等）两大类。

### 周边目标Objects

1) 标记<br />标记包括各类交通标志、交通信号灯、斑马线、铁路道口、呼救、施工标志、其它道路使用者发出的信号、手势。<br />2) 道路使用者<br />常见的道路使用者包括各种车辆（轿车、轻卡、重卡、公共汽车、工程车辆、应急车辆、特殊车辆等）、行人（大人、儿童）、骑两轮车的人（自行车、电瓶车、摩托车）等<br />3) 非道路使用者的障碍物/物体<br />非道路使用者的障碍物/物体包括动物、工程设备、路面障碍物等

### 互联Connectivity

互联Connectivity可理解为V2X，即车与任何事物的通信，具体可包括V2V车与车、V2I车与基础设施、V2P车与人、V2N车与云。

### 环境条件Environmental Conditions

环境条件主要考虑天气、受天气影响的道路条件、颗粒物和光照四项属性。<br />1) 天气<br />天气情况对传感器的影响较大。根据统计，在高速公路上，小雨或小雪可使平均车速降低3%至13%；大雨可以使平均速度降低3%到16%；大雪可以使平均速度下降5%到40%。<br />设计运行区域主要考虑风、雨、雪、雨夹雪、温度等天气情况。<br />2) 受天气影响的道路条件<br />雨雪天气下产生的道路积水、淹没、结冰、积雪等情况降低了轮胎的道路附着力，进而影响智能驾驶系统的运动控制能力。<br />3) 颗粒物<br />大气中的雾、霾、烟雾、灰尘等都会影响可见度，降低传感器的感知能力。<br />4) 光照<br />光照太强或光照太弱都会影响摄像头的感知能力，实际中所处时段（白天、黎明、黄昏、夜晚）、道路周边设施照明（路灯、建筑灯光）和车灯都会影响光照条件。

### 区域Zones

智能驾驶功能可能受到所处区域的空间限制，这些区域的边界可以是固定的，也可能是动态的。<br />1) 地理围栏<br />所谓地理围栏指的是用一个虚拟的栅栏围出一个虚拟地理边界，典型应用包括：中央商务区CBD、园区等。<br />2) 交通管制区域<br />交通管制区域可能包括临时车道封闭、动态交通标志、可变限速标志、临时车道标记、人工交通引导等。<br />3) 学校/施工区域<br />在学校或施工区域，动态限速、行人和车辆行为均不稳定。<br />4) 国家/地区<br />不同国家或地区存在交通法规、交通标记等差异。<br />5) 信号干扰区域<br />在隧道、停车场、茂密的树叶、高层建筑、大气条件等都会影响GNSS信号。

## OEDR的逻辑架构

目标和事件探测与响应<br />探测：对目标和事件的探测、识别和分类；<br />响应：对目标和事件探测结果的响应。<br />对于智能驾驶系统来说，OEDR是一项非常重要的功能，代表了系统探测与驾驶直接相关的环境因素及响应的能力，是决定驾驶自动化水平的重要因素。<br />![](https://cdn.nlark.com/yuque/0/2022/png/23125517/1671423125395-a0a9cd75-1262-41f0-a8c7-34419db91931.png#averageHue=%23fcfcfb&clientId=uf6366bc0-124d-4&crop=0&crop=0&crop=1&crop=1&from=paste&id=ucd426d98&margin=%5Bobject%20Object%5D&originHeight=406&originWidth=688&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=ub3cd3754-a999-4dbc-a3ef-b97b75560a6&title=)<br />1) 交通规则<br />所有智能驾驶车型都需要遵守其设计运行区域ODD中的交通规则，例如限速、限行、交通标志、交通灯等。<br />2) 环境感知传感器<br />环境感知传感器的作用是探测所有外部信息，用以创建世界模型。环境感知传感器需要探测的实体包括但不限于定义可行驶区域的设施、道路使用者、障碍物、交通标志和声音信号。<br />考虑到目前传感器能力的限制即安全冗余的需求，目前智能驾驶系统通常会使用不同类型的传感器进行组合，常见的传感器有：摄像头、激光雷达、毫米波雷达、超声波雷达等。<br />传感器的选择与布置很大程度上由智能驾驶系统的设计运行区域ODD决定，必须确保传感器组合可以提供对设计运行区域中所有可能目标和事件的检测、分类、测量和不利条件下的鲁棒性。<br />3) V2X<br />车辆与基础设施、云端、其它车辆、人的通讯可以为智能驾驶系统提供很多有价值的信息<br />_图 3 V2X_<br />4) 先验感知传感器<br />所谓先验感知传感器主要指的是高精地图和全球卫星导航系统GNSS。

- 高精地图

单纯依靠环境感知传感器不足以满足某些情况下智能驾驶系统高可靠性、可用性和安全性的要求，因此高精地图是智能驾驶系统必须的补充。高精地图的作用主要包括：

1. 凭借精心处理的先验信息，“检测”环境感知传感器无法轻易检测到的物体，例如基于位置的ODD检测、不利条件下的环境建模以及复杂驾驶情况下的精确语义理解；
2. 在环境感知传感器无法可靠检测的情况下，高精地图还可用作更可靠的冗余信息源。

- GNSS

基于位置的ODD检测不仅需要高精地图，还需要GNSS的绝对定位，在某些信号干扰区域，GNSS需与IMU进行组合使用。<br />5) 定位<br />智能驾驶系统需要精确地知道车辆在高精地图上的位置，具体实现方式包括：

- 基于GNSS的定位

该方法包括GNSS、里程计和校正服务，目的在于获得精确的全局坐标，并将GNSS测量与高精地图匹配，以获得在地图上的相对位置。

- 基于环境感知传感器的定位

通过GNSS和测距法获得粗略的全局坐标，并将环境感知传感器检测到的现实特征或点云与高精地图上的相应特征或点云相匹配，以实现在地图上的定位。<br />6) 传感器融合<br />传感器融合就是将多个传感器获取的数据、信息集中在一起综合分析以便更加准确可靠地描述外界环境，从而提高系统决策的正确性。<br />算法是多传感器融合的核心，其基本原理就像人脑综合处理信息一样，充分利用多个传感器资源，通过对多传感器及其观测信息的合理支配和使用，把多传感器在空间或时间上冗余或互补信息依据某种准则来进行组合，以获得被测对象的一致性解释或描述。<br />7) 解释和预测<br />智能驾驶系统需要对所处驾驶场景进行预测，一个主要难点在于对其它道路使用者行为的预测。而要想做到很好的预测，需要先对当前环境进行解释。在没有可测量或共同属性的情况下，是不可能基于概率计算建立安全性的，特别是人类道路使用者，可能会做出不合理的决定。<br />8) 驾驶规划<br />驾驶规划指的是智能驾驶系统根据感知结果及驾驶任务，制定一项可以实现无碰撞驾驶的行驶策略。通常可依据一些显性规则和隐性规则进行驾驶规划。

- 显性规则

显性规则主要指的是在智能驾驶系统设计运行区域内适用的各项交通法规

- 隐性规则

可参考的部分隐性规则如下：

1. 正常情况下，与其它道路使用者保持安全距离，以避免碰撞。但应预期其他道路使用者不遵守交通规则的情景，并进行防御性处理；
2. 在其他道路使用者可能被遮挡的区域要小心，需准备好可能突然出现的情况；
3. 如果可以执行合法且安全的操作以避开潜在的不安全情况，则智能驾驶系统应执行这一操作；
4. 如果在不违反交通规则的情况下无法避免发生事故，则智能驾驶系统可以选择违反交通规则的安全操作策略。

# 结语

人机交互，监管诊断都是为安全服务的，而汽车的安全是用功能安全来定义和建模的。<br />所有的功能都应该在基于功能安全分析的基础上进行设计和实现。<br />最终都是安全。

# 参考

微信公众号, 焉知自动驾驶odd

- L3该不该放弃？
- 自动驾驶系统功能场景系列
- 智能驾驶需求的智能座舱升级方案
- 自动驾驶人机交互
