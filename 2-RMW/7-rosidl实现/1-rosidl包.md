# 静态类型直接生成

The `rosidl` [API](https://docs.ros.org/en/foxy/Glossary.html#term-API) consists of a few message related static functions and types along with a definition of what code should be generated by messages in different languages. The generated message code specified in the [API](https://docs.ros.org/en/foxy/Glossary.html#term-API) will be language specific, but may or may not reuse generated code for other languages. The generated message code specified in the [API](https://docs.ros.org/en/foxy/Glossary.html#term-API) contains things like the message data structure, functions for construction, destruction, etc. The [API](https://docs.ros.org/en/foxy/Glossary.html#term-API) will also implement a way to get the type support structure for the message type, which is used when publishing or subscribing to a topic of that message type.There are several repositories that play a role in the `rosidl` [API](https://docs.ros.org/en/foxy/Glossary.html#term-API) and implementation.The `rosidl` repository, located on [GitHub](https://github.com/) at [ros2/rosidl](https://github.com/ros2/rosidl), defines the message IDL syntax, i.e. syntax of `.msg` files, `.srv` files, etc., and contains [packages](https://docs.ros.org/en/foxy/Glossary.html#term-package) for parsing the files, for providing CMake infrastructure to generate code from the messages, for generating implementation agnostic code (headers and source files), and for establishing the default set of generators. The repository contains these [packages](https://docs.ros.org/en/foxy/Glossary.html#term-package):

rosidl是静态生成msg, srv, action的包

- `rosidl_cmake`: provides CMake functions and CMake Modules for generating code from `rosidl` files, e.g. `.msg` files, `.srv` files, etc.

- `rosidl_default_generators`: defines the list of default generators which ensures that they are installed as dependencies, but other injected generators can also be used.

- `rosidl_generator_c`: provides tools to generate C header files (`.h`) for `rosidl` files.

- `rosidl_generator_cpp`: provides tools to generate C++ header files (`.hpp`) for `rosidl` files.

- `rosidl_generator_py`: provides tools to generate Python modules for `rosidl` files.

- `rosidl_parser`: provides Python [API](https://docs.ros.org/en/foxy/Glossary.html#term-API) for parsing `rosidl` files.

Generators for other languages, e.g. `rosidl_generator_java`, are hosted externally (in different repositories) but would use the same mechanism that the above generators use to “register” themselves as a `rosidl` generator.

## 默认生成器

rosidl_typesupport_c和rosidl_typesupport_cpp，生成从msg到typesupport的元数据

rosidl_defaults，rosidl_runtime,  rosidl_typesupport

## proto生成器

ecal支持protobuf的type，

![](https://tcs.teambition.net/storage/312geb93f40028464f4ebb91caf3dd24f683?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTY3MTc5OTA0MywiaWF0IjoxNjcxMTk0MjQzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmdlYjkzZjQwMDI4NDY0ZjRlYmI5MWNhZjNkZDI0ZjY4MyJ9.85HMhADDIJAubt_0TfhVLVwCY0W7KPEJsWrpwAHW-9o&download=image.png "")

由于protobuf不是ros2官方的类型，没有proto与msg关系，还要一个rosidl_typesupport_protobuf

rosidl_typesupport_protobuf是生成msg到protobuf的typesupport的元数据

## fastrtps生成器

![](https://tcs.teambition.net/storage/312g107c938f79d5170beb6b61e61b7ec111?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTY3MTc5OTA0MywiaWF0IjoxNjcxMTk0MjQzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmcxMDdjOTM4Zjc5ZDUxNzBiZWI2YjYxZTYxYjdlYzExMSJ9.Q10zUDSWJn3RYbLxiPjDavh4mhNBGjRV3UHuydP_lmI&download=image.png "")

# 静态类型间接生成

rosidl_dds

`rosidl_generator_dds_idl`

Common Packages for DDS Middleware Packages[](https://docs.ros.org/en/rolling/Concepts/About-Middleware-Implementations.html#common-packages-for-dds-middleware-packages "Permalink to this headline")

All of the current ROS middleware implementations are based on full or partial DDS implementations. For example, there is a middleware implementation that uses RTI’s Connext DDS and an implementation which uses eProsima’s Fast DDS. Because of this, there are some shared [packages](https://docs.ros.org/en/rolling/Glossary.html#term-package) amongst most DDS based middleware implementations.

In the [ros2/rosidl_dds](https://github.com/ros2/rosidl_dds) repository on [GitHub](https://github.com/), there is the following [package](https://docs.ros.org/en/rolling/Glossary.html#term-package):

- `rosidl_generator_dds_idl`: provides tools to generate DDS `.idl` files from `rosidl` files, e.g. `.msg` files, `.srv` files, etc.

The `rosidl_generator_dds_idl` [package](https://docs.ros.org/en/rolling/Glossary.html#term-package) generates a DDS `.idl` file for each `rosidl` file, e.g. `.msg` file, defined by [packages](https://docs.ros.org/en/rolling/Glossary.html#term-package) containing messages. Currently DDS based ROS middleware implementations make use of this generator’s output `.idl` files to generate pre-compiled type support that is vendor specific.

## 例子

目前没有rmw使用该方法

# 动态生成

In addition to the aforementioned [packages](https://docs.ros.org/en/foxy/Glossary.html#term-package) for parsing and generating headers for the `rosidl` files, the `rosidl` repository also contains [packages](https://docs.ros.org/en/foxy/Glossary.html#term-package) concerned with “type support” for the message types defined in the files. Type support refers to the ability to interpret and manipulate the information represented by ROS message instances of particular types (publishing the messages, for example). Type support can either be provided by code that is generated at compile time or it can be done programmatically based on the contents of the `rosidl` file, e.g. the `.msg` or `.srv` file, and the data received, by introspecting the data. In the case of the latter, where type support is done through runtime interpretation of the messages, the message code generated by ROS 2 can be agnostic to the rmw implementation. The packages that provide this type support through introspection of the data are:

- `rosidl_typesupport_introspection_c`: provides tools for generating C code for supporting `rosidl` message data types.

- `rosidl_typesupport_introspection_cpp`: provides tools for generating C++ code for supporting `rosidl` message data types.

In the case where type support is to be generated at compile time instead of being generated programmatically, a package specific to the rmw implementation will need to be used. This is because typically a particular rmw implementation will require data to be stored and manipulated in a manner that is specific to the DDS vendor in order for the DDS implementation to make use of it. See the [Type Specific Interfaces](https://docs.ros.org/en/foxy/Concepts/About-Internal-Interfaces.html?highlight=middleware#type-specific-interfaces) section above for more details.

动态生成还需要rmw的支持，并不是看是否有rosidl_typesupport_fastrtps包，而是看type_support相关函数设计

## cyclonedds

cyclonedds内置dynamic_typesupport，没有静态类型支持

![](https://tcs.teambition.net/storage/312ge70fc63aa9fdeafd3394f3a04d80eab6?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTY3MTc5OTA0MywiaWF0IjoxNjcxMTk0MjQzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmdlNzBmYzYzYWE5ZmRlYWZkMzM5NGYzYTA0ZDgwZWFiNiJ9.YvPXtUXLbaFQla31GX7JripLqDXMQEpMMwoVNT_hSuk&download=image.png "")

## ecal

支持dynamic，其支持msg的动态类型支持，所以直接使用rosidl的包接口即可

![](https://tcs.teambition.net/storage/312g95c14e54c087938ab89baced3d051997?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTY3MTc5OTA0MywiaWF0IjoxNjcxMTk0MjQzLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzMxMmc5NWMxNGU1NGMwODc5MzhhYjg5YmFjZWQzZDA1MTk5NyJ9.K1vXjv1EfHCt6FPtaeT1X8S3s0nEU2MnAQwqHOQghfo&download=image.png "")

## fastrtps

# 总结

| 库      | 包              | 功能介绍 | 备注  |
| ------ | -------------- | ---- | --- |
| rosidl |                |      |     |
|        | rosidl_adapter |      |     |
|        |                |      |     |
